<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Beer Tracker">
  <meta name="theme-color" content="#0a0a0f">
  <meta name="description" content="Track 1,000,000 beers with friends">
  <title>BEER TRACKER - 1,000,000 GOAL</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&family=Roboto+Mono:wght@700&display=swap" rel="stylesheet">
  <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üç∫</text></svg>">
</head>
<body>
  <div id="app">
    <!-- Countdown Overlay -->
    <div id="countdown-overlay" class="countdown-overlay hidden">
      <h1 class="countdown-title">MILLION BEER CHALLENGE</h1>
      <p class="countdown-subtitle">LAUNCHES IN</p>
      <div class="countdown-timer">
        <div class="countdown-unit">
          <div class="countdown-value" id="countdown-hours">00</div>
          <div class="countdown-label">HOURS</div>
        </div>
        <div class="countdown-unit">
          <div class="countdown-value" id="countdown-minutes">00</div>
          <div class="countdown-label">MINS</div>
        </div>
        <div class="countdown-unit">
          <div class="countdown-value" id="countdown-seconds">00</div>
          <div class="countdown-label">SECS</div>
        </div>
      </div>
      <p class="countdown-goal">GOAL: 1,000,000 BEERS</p>
    </div>

    <!-- Auth Screen -->
    <div id="auth-screen" class="screen">
      <div class="auth-container">
        <div class="scoreboard-header">
          <h1 class="neon-title">MILLION BEER<br>CHALLENGE</h1>
          <div class="goal-badge">GOAL: 1,000,000</div>
        </div>

        <div id="login-form" class="auth-form">
          <h2>PLAYER LOGIN</h2>
          <input type="email" id="login-username" placeholder="EMAIL" autocomplete="email">
          <input type="password" id="login-password" placeholder="PASSWORD" autocomplete="current-password">
          <button onclick="login()" class="btn-primary">ENTER ARENA</button>
          <p class="switch-text"><a href="#" onclick="showForgotPassword()">Forgot password?</a></p>
          <p class="switch-text">Got an invite? <a href="#" onclick="showRegister()">Join the team</a></p>
        </div>

        <div id="forgot-form" class="auth-form hidden">
          <h2>RESET PASSWORD</h2>
          <input type="email" id="forgot-email" placeholder="YOUR EMAIL" autocomplete="email">
          <button onclick="requestReset()" class="btn-primary">SEND RESET CODE</button>
          <p class="switch-text"><a href="#" onclick="showLogin()">Back to login</a></p>
        </div>

        <div id="reset-form" class="auth-form hidden">
          <h2>NEW PASSWORD</h2>
          <input type="text" id="reset-code" placeholder="RESET CODE">
          <input type="password" id="new-password" placeholder="NEW PASSWORD" autocomplete="new-password">
          <input type="password" id="confirm-password" placeholder="CONFIRM PASSWORD" autocomplete="new-password">
          <button onclick="resetPassword()" class="btn-primary">SET NEW PASSWORD</button>
          <p class="switch-text"><a href="#" onclick="showLogin()">Back to login</a></p>
        </div>

        <div id="register-form" class="auth-form hidden">
          <h2>JOIN THE TEAM</h2>
          <input type="text" id="invite-code" placeholder="INVITE CODE">
          <input type="email" id="reg-email" placeholder="YOUR EMAIL" autocomplete="email">
          <input type="text" id="reg-displayname" placeholder="DISPLAY NAME" autocomplete="nickname">
          <input type="password" id="reg-password" placeholder="CHOOSE PASSWORD" autocomplete="new-password">
          <button onclick="register()" class="btn-primary">JOIN CHALLENGE</button>
          <p class="switch-text">Already a player? <a href="#" onclick="showLogin()">Login</a></p>
        </div>

        <div id="auth-error" class="error-msg hidden"></div>
      </div>
    </div>

    <!-- Dashboard Screen -->
    <div id="dashboard-screen" class="screen hidden">
      <header class="dashboard-header">
        <div class="team-info" onclick="showEditProfile()">
          <div id="header-profile-photo" class="header-profile-photo">
            <span>&#127866;</span>
          </div>
          <span id="player-name">PLAYER</span>
          <span id="admin-badge" class="admin-badge hidden">ADMIN</span>
        </div>
        <div class="header-actions">
          <button onclick="generateInvite()" class="btn-invite">+ INVITE</button>
          <button id="reset-btn" onclick="showResetConfirm()" class="btn-reset hidden">RESET</button>
          <button onclick="logout()" class="btn-logout">LOGOUT</button>
        </div>
      </header>

      <main class="scoreboard-main">
        <!-- Giant Counter -->
        <section class="counter-section">
          <div class="counter-label">BEERS REMAINING</div>
          <div class="mega-counter" id="mega-counter">
            <span class="digit">0</span>
            <span class="digit">0</span>
            <span class="digit">0</span>
            <span class="digit">,</span>
            <span class="digit">0</span>
            <span class="digit">0</span>
            <span class="digit">0</span>
          </div>
          <div class="goal-tracker">
            <div class="goal-bar">
              <div class="goal-fill" id="goal-fill"></div>
            </div>
            <div class="goal-text">
              <span id="progress">0</span> BEERS DRANK!
            </div>
          </div>
        </section>

        <!-- Drink Section with Beer Type and Photo -->
        <section class="drink-section">
          <div class="beer-type-input">
            <input type="text" id="beer-type" placeholder="WHAT BEER? (e.g. IPA, Lager, Stout)" maxlength="50">
          </div>
          <div class="photo-upload">
            <label for="beer-photo" class="photo-label">
              <span id="photo-icon">&#128247;</span>
              <span id="photo-text">SNAP YOUR BEER</span>
            </label>
            <input type="file" id="beer-photo" accept="image/*" capture="environment" onchange="handlePhotoSelect(this)">
            <div id="photo-preview" class="photo-preview hidden">
              <img id="preview-img" src="" alt="Beer preview">
              <button onclick="clearPhoto()" class="clear-photo">X</button>
            </div>
          </div>
          <button id="drink-btn" onclick="drinkBeer()" class="mega-drink-btn">
            <span class="beer-icon">&#127866;</span>
            <span class="drink-text">DRINK!</span>
          </button>
          <div id="verification-status" class="verification-status hidden"></div>
          <div class="your-count">
            YOUR BEERS: <span id="your-beers">0</span>
          </div>
          <button onclick="openDrunkAI()" class="btn-drunk-ai">
            <span>&#129312;</span> CHAT WITH DRUNK.AI
          </button>
        </section>

        <!-- Recent Drinks -->
        <section class="recent-section">
          <div class="recent-header">
            <h2>RECENT DRINKS</h2>
          </div>
          <div class="recent-drinks" id="recent-drinks">
            <!-- Populated by JS -->
          </div>
        </section>

        <!-- Leaderboard -->
        <section class="leaderboard-section">
          <div class="leaderboard-header">
            <h2>&#127942; LEADERBOARD &#127942;</h2>
          </div>
          <div class="leaderboard-table" id="leaderboard">
            <!-- Populated by JS -->
          </div>
        </section>
      </main>

      <!-- Chat View (hidden by default) -->
      <div id="chat-view" class="chat-view hidden">
        <div class="chat-header">
          <h2>BEER CHAT</h2>
        </div>
        <div class="chat-messages" id="chat-messages">
          <!-- Messages populated by JS -->
        </div>
        <div class="chat-input-area">
          <input type="text" id="chat-input" placeholder="Type a message..." maxlength="500">
          <button onclick="sendMessage()" class="btn-send">SEND</button>
        </div>
      </div>

      <!-- Bottom Tab Bar -->
      <nav class="tab-bar">
        <button class="tab-item active" onclick="switchTab('home')" id="tab-home">
          <span class="tab-icon">&#127866;</span>
          <span class="tab-label">DRINK</span>
        </button>
        <button class="tab-item" onclick="switchTab('chat')" id="tab-chat">
          <span class="tab-icon">&#128172;</span>
          <span class="tab-label">CHAT</span>
        </button>
        <button class="tab-item" onclick="switchTab('leaderboard')" id="tab-leaderboard">
          <span class="tab-icon">&#127942;</span>
          <span class="tab-label">RANKS</span>
        </button>
      </nav>

      <!-- Invite Modal -->
      <div id="invite-modal" class="modal hidden">
        <div class="modal-content">
          <h3>INVITE A TEAMMATE</h3>
          <p>Share this link:</p>
          <input type="text" id="invite-link" readonly>
          <button onclick="copyInvite()" class="btn-primary">COPY LINK</button>
          <button onclick="closeInviteModal()" class="btn-secondary">CLOSE</button>
        </div>
      </div>

      <!-- Reset Confirmation Modal -->
      <div id="reset-modal" class="modal hidden">
        <div class="modal-content reset-modal">
          <h3>RESET ALL PROGRESS?</h3>
          <p class="reset-warning">This will reset ALL beer counts to 0 and delete all drink history. This cannot be undone!</p>
          <button onclick="confirmReset()" class="btn-danger">YES, RESET EVERYTHING</button>
          <button onclick="closeResetModal()" class="btn-secondary">CANCEL</button>
        </div>
      </div>

      <!-- Profile Setup Modal (shown after first login) -->
      <div id="profile-setup-modal" class="modal hidden">
        <div class="modal-content profile-modal">
          <h3>COMPLETE YOUR PROFILE</h3>
          <p>Tell us about yourself!</p>
          <div class="profile-photo-upload">
            <div id="setup-photo-preview" class="profile-photo-circle">
              <span>+</span>
            </div>
            <label for="setup-photo-input" class="photo-upload-label">Upload Photo</label>
            <input type="file" id="setup-photo-input" accept="image/*" onchange="handleProfilePhotoSelect(this, 'setup')">
          </div>
          <textarea id="setup-beer-fact" placeholder="YOUR FAVORITE BEER FACT..." maxlength="200"></textarea>
          <button onclick="saveProfileSetup()" class="btn-primary">SAVE PROFILE</button>
        </div>
      </div>

      <!-- View Profile Modal -->
      <div id="view-profile-modal" class="modal hidden">
        <div class="modal-content profile-modal">
          <div id="profile-photo-display" class="profile-photo-circle large">
            <span>?</span>
          </div>
          <h3 id="profile-username">USERNAME</h3>
          <div id="profile-admin-tag" class="profile-admin-tag hidden">ADMIN</div>
          <div class="profile-stats">
            <div class="profile-stat">
              <span class="stat-value" id="profile-beers">0</span>
              <span class="stat-label">BEERS</span>
            </div>
            <div class="profile-stat">
              <span class="stat-value" id="profile-since">-</span>
              <span class="stat-label">MEMBER SINCE</span>
            </div>
          </div>
          <div class="profile-fact-section">
            <h4>BEER FACT</h4>
            <p id="profile-fact">No beer fact yet!</p>
          </div>
          <button onclick="closeProfileModal()" class="btn-secondary">CLOSE</button>
        </div>
      </div>

      <!-- Drunk AI Chat Modal -->
      <div id="drunk-ai-modal" class="modal hidden">
        <div class="modal-content drunk-ai-modal">
          <div class="drunk-ai-header">
            <span class="drunk-ai-icon">&#129312;</span>
            <h3>DRUNK.AI</h3>
            <p class="drunk-ai-subtitle">10 Molsons deep in Whistler</p>
          </div>
          <div class="drunk-ai-messages" id="drunk-ai-messages">
            <div class="drunk-ai-msg ai">
              <p>*burp* heyyy buddy!! whatcha wanna talk about?? I just did like 10 molsons eh and this mountain air is HITTING different üç∫üèîÔ∏è</p>
            </div>
          </div>
          <div class="drunk-ai-input-area">
            <input type="text" id="drunk-ai-input" placeholder="Ask drunk.ai anything..." maxlength="200">
            <button onclick="sendDrunkAIMessage()" class="btn-send">ASK</button>
          </div>
          <button onclick="closeDrunkAI()" class="btn-secondary">CLOSE</button>
        </div>
      </div>

      <!-- Edit Profile Modal -->
      <div id="edit-profile-modal" class="modal hidden">
        <div class="modal-content profile-modal">
          <h3>EDIT PROFILE</h3>
          <div class="profile-photo-upload">
            <div id="edit-photo-preview" class="profile-photo-circle">
              <span>+</span>
            </div>
            <label for="edit-photo-input" class="photo-upload-label">Change Photo</label>
            <input type="file" id="edit-photo-input" accept="image/*" onchange="handleProfilePhotoSelect(this, 'edit')">
          </div>
          <textarea id="edit-beer-fact" placeholder="YOUR FAVORITE BEER FACT..." maxlength="200"></textarea>
          <button onclick="saveProfileEdit()" class="btn-primary">SAVE CHANGES</button>
          <button onclick="closeEditProfileModal()" class="btn-secondary">CANCEL</button>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
